package redact_test

import (
	"testing"

	"github.com/stretchr/testify/assert"

	"github.com/xeptore/tidalgram/redact"
)

func TestRedactString(t *testing.T) {
	t.Parallel()
	pairs := [][2]string{
		{
			"abcdefghijklmnopqrstuvwxyz",
			"abcdef**************uvwxyz",
		},
		{
			"abcdefghijklmnopqrstuvwxy",
			"abcdef*************tuvwxy",
		},
		{
			"abcdefghijklmnopqrstuvwx",
			"abcdef************stuvwx",
		},
		{
			"abcdefghijklmnopqrstuvw",
			"abcde*************stuvw",
		},
		{
			"abcdefghijklmnopqrstuv",
			"abcde************rstuv",
		},
		{
			"abcdefghijklmnopqrstu",
			"abcde***********qrstu",
		},
		{
			"abcdefghijklmnopqrst",
			"abcde**********pqrst",
		},
		{
			"abcdefghijklmnopqrs",
			"abcd***********pqrs",
		},
		{
			"abcdefghijklmnopqr",
			"abcd**********opqr",
		},
		{
			"abcdefghijklmnopq",
			"abcd*********nopq",
		},
		{
			"abcdefghijklmnop",
			"abcd********mnop",
		},
		{
			"abcdefghijklmno",
			"abc*********mno",
		},
		{
			"abcdefghijklmn",
			"abc********lmn",
		},
		{
			"abcdefghijklm",
			"abc*******klm",
		},
		{
			"abcdefghijkl",
			"abc******jkl",
		},
		{
			"abcdefghijk",
			"ab*******jk",
		},
		{
			"abcdefghij",
			"ab******ij",
		},
		{
			"abcdefghi",
			"ab*****hi",
		},
		{
			"abcdefgh",
			"ab****gh",
		},
		{
			"abcdefg",
			"a*****g",
		},
		{
			"abcdef",
			"a****f",
		},
		{
			"abcde",
			"a***e",
		},
		{
			"abcd",
			"a**d",
		},
		{
			"abc",
			"***",
		},
		{
			"ab",
			"**",
		},
		{
			"a",
			"*",
		},
		{
			"",
			"",
		},
	}
	for _, pair := range pairs {
		assert.Equal(t, pair[1], redact.String(pair[0]))
	}
}
